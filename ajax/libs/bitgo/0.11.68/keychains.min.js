var HDNode=require("./hdnode"),crypto=require("crypto"),common=require("./common"),Util=require("./util"),Keychains=function(e){this.bitgo=e};Keychains.prototype.isValid=function(e){if(e=e||{},common.validateParams(e,[],[]),"string"!=typeof e.key&&"object"!=typeof e.key)throw new Error("key must be a string or object");try{return e.key.path?HDNode.fromBase58(e.key.xpub).deriveFromPath(e.key.path):HDNode.fromBase58(e.key),!0}catch(t){return!1}},Keychains.prototype.create=function(e){e=e||{},common.validateParams(e,[],[]);var t;t=e.seed?e.seed:crypto.randomBytes(64);var o=HDNode.fromSeedBuffer(t);return{xpub:o.neutered().toBase58(),xprv:o.toBase58()}},Keychains.prototype.list=function(e,t){return e=e||{},common.validateParams(e,[],[],t),this.bitgo.get(this.bitgo.url("/keychain")).result("keychains").nodeify(t)},Keychains.prototype.add=function(e,t){return e=e||{},common.validateParams(e,["xpub"],["encryptedXprv"],t),this.bitgo.post(this.bitgo.url("/keychain")).send(e).result().nodeify(t)},Keychains.prototype.createBitGo=function(e,t){return e=e||{},common.validateParams(e,[],[],t),this.bitgo.post(this.bitgo.url("/keychain/bitgo")).send({}).result().nodeify(t)},Keychains.prototype.createBackup=function(e,t){return e=e||{},common.validateParams(e,["provider"],[],t),this.bitgo.post(this.bitgo.url("/keychain/backup")).send(e).result().nodeify(t)},Keychains.prototype.get=function(e,t){return e=e||{},common.validateParams(e,["xpub"],[],t),this.bitgo.post(this.bitgo.url("/keychain/"+e.xpub)).send({}).result().nodeify(t)},Keychains.prototype.update=function(e,t){return e=e||{},common.validateParams(e,["xpub"],["encryptedXprv"],t),this.bitgo.put(this.bitgo.url("/keychain/"+e.xpub)).send({encryptedXprv:e.encryptedXprv}).result().nodeify(t)},module.exports=Keychains;